---
name: Remove Quarantine Attribute
description: |
  This TTP leverages xattr and cat to remove the com.apple.quarantine attribute
  from a file.
mitre:
  tactics:
    - TA0005 Defense Evasion
  techniques:
    - T1553 Subvert Trust Controls
steps:
  - name: xattr-remove-attrib
    inline: |
      set -e

      echo -e "Running xattr against the included Test.app bundle to remove \
      the com.apple.quarantine attribute..."
      unzip TTPBundledFiles.zip
      echo -e "List of extended attributes before removal:\n"
      xattr Test.app
      echo -e "List of extended attributes after removal:\n"
      xattr -c Test.app
      echo "[+] xattr execution Done!"
      rm -rf Test.app

  - name: cat-remove-attrib
    inline: |
      set -e

      echo -e "Running cat against the included TTPBundledFiles.zip archive to remove \
      the com.apple.quarantine attribute..."
      echo -e "List of extended attributes before removal:\n"
      xattr TTPBundledFiles.zip
      echo -e "List of extended attributes after removal:\n"
      cat TTPBundledFiles.zip > TTPBundledFiles2.zip
      xattr TTPBundledFiles2.zip
      echo "[+] cat execution Done!"

    cleanup:
      inline: |
        set -e

        rm TTPBundledFiles2.zip
        rm -rf Test.app
        echo "[+] Cleanup done!"
