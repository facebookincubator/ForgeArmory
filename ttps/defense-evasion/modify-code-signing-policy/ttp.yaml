# Converted from Atomic Red Team - Subvert Trust Controls: Code Signing Policy Modification
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1553.006
# Original auto_generated_guid: bb6b51e1-ab92-45b5-aeea-e410d06405f8

---
api_version: 2.0
uuid: 19ac0f38-e6f5-4b7b-9fad-c1af81425ac9
name: Code Signing Policy Modification
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Allows adversaries to subvert trust controls by modifying the code signing policy, enabling the execution of unsigned drivers.

  This requires Secure Boot to be disabled to function properly. Typical Windows 11 installations will have this enabled by default.

mitre:
  tactics:
    - "TA0005 Defense Evasion"
  techniques:
    - "T1553 Subvert Trust Controls"
  subtechniques:
    - "T1553.006 Code Signing Policy Modification"

requirements:
  platforms:
    - os: windows
  superuser: true

steps:
  - name: enable_test_signing
    executor: cmd.exe
    inline: |
      bcdedit /set testsigning on
    cleanup:
      executor: cmd.exe
      inline: |
        bcdedit /set testsigning off
