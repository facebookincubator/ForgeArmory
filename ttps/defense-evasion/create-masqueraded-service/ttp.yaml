# Converted from Atomic Red Team - Masquerading: Masquerade Task or Service
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1036.004
# Original auto_generated_guid: b721c6ef-472c-4263-a0d9-37f1f4ecff66

---
api_version: 2.0
uuid: 4f21778a-e5de-47cb-86b5-9769c2daaf35
name: Creating W32Time similar named service using sc
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Creating W32Time similar named service (win32times) using sc just like threat actor dubbed "Operation Wocao"

mitre:
  tactics:
    - "TA0005 Defense Evasion"
  techniques:
    - "T1036 Masquerading"
  subtechniques:
    - "T1036.004 Masquerade Task or Service"

requirements:
  platforms:
    - os: windows
  superuser: true

args:
  - name: command
    description: Command to execute
    type: string
    default: "powershell.exe -c whoami"
  - name: service_name
    description: Name of the service to create
    type: string
    default: "win32times"

steps:
  - name: create_masqueraded_service
    executor: cmd.exe
    inline: |
      sc create {{.Args.service_name}} binPath= "cmd /c {{.Args.command}}"
      sc qc {{.Args.service_name}}
    cleanup:
      executor: cmd.exe
      inline: |
        sc delete {{.Args.service_name}}
