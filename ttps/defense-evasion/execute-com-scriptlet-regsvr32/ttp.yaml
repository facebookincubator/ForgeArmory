# Converted from Atomic Red Team - Signed Binary Proxy Execution: Regsvr32
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1218.010
# Original auto_generated_guid: 449aa403-6aba-47ce-8a37-247d21ef0306

---
api_version: 2.0
uuid: 12de672c-760f-4a8a-90e1-187230fc4aa5
name: Regsvr32 local COM scriptlet execution
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Regsvr32.exe is a command-line program used to register and unregister OLE controls. Upon execution, calc.exe will be launched.

mitre:
  tactics:
    - "TA0005 Defense Evasion"
  techniques:
    - "T1218 Signed Binary Proxy Execution"
  subtechniques:
    - "T1218.010 Regsvr32"

requirements:
  platforms:
    - os: windows
  superuser: false

args:
  - name: filename
    description: Name of the local file, include path
    type: path
    default: "./RegSvr32.sct"

steps:
  - name: ensure_scriptlet_exists
    executor: powershell
    inline: |
      if (-not (Test-Path "{{.Args.filename}}")) {
        Write-Error "Regsvr32.sct not found at {{.Args.filename}}. Exiting..."
        exit 1
      }

  - name: execute_regsvr32_scriptlet
    executor: cmd.exe
    inline: |
      regsvr32.exe /s /u /i:"{{.Args.filename}}" scrobj.dll
