# Converted from Atomic Red Team - Command and Scripting Interpreter: Windows Command Shell
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1059.003
# Original auto_generated_guid: 127b4afe-2346-4192-815c-69042bec570e

---
api_version: 2.0
uuid: bafe0b67-0d00-421b-9983-3cc893f2e81c
name: Writes text to a file and displays it.
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Writes text to a file and display the results. This test is intended to emulate the dropping of a malicious file to disk.

mitre:
  tactics:
    - "TA0002 Execution"
  techniques:
    - "T1059 Command and Scripting Interpreter"
  subtechniques:
    - "T1059.003 Windows Command Shell"

requirements:
  platforms:
    - os: windows

args:
  - name: file_contents_path
    description: Path to the file that the command prompt will drop
    type: path
    default: "C:\\Users\\Public\\test.bin"
  - name: message
    description: Message that will be written to disk and then displayed
    type: string
    default: "Hello from the Windows Command Prompt!"

steps:
  - name: write_and_display_file
    executor: cmd.exe
    inline: |
      echo "{{.Args.message}}" > "{{.Args.file_contents_path}}" & type "{{.Args.file_contents_path}}"
    cleanup:
      inline: |
        rm "{{.Args.file_contents_path}}"
