# Converted from Atomic Red Team - Command and Scripting Interpreter: Visual Basic
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1059.005
# Original auto_generated_guid: 1620de42-160a-4fe5-bbaf-d3fef0181ce9

---
api_version: 2.0
uuid: 99773e10-97da-4339-a1ad-f3191d9d7e1d
name: Visual Basic script execution to gather local computer information
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Visual Basic execution test, execute vbscript via PowerShell.
  When using cscript, system information will be written to the console.
  When using wscript, system information will be shown with message boxes.

mitre:
  tactics:
    - TA0002 Execution
  techniques:
    - T1059 Command and Scripting Interpreter
  subtechniques:
    - T1059.005 Visual Basic

requirements:
  platforms:
    - os: windows
  superuser: false

args:
  - name: method
    description: The method to execute VBA script
    type: string
    choices:
    - cscript
    - wscript
    default: cscript
  - name: vbscript_path
    description: Path to VBScript file
    type: path
    default: "./sys_info.vbs"

steps:
  - name: ensure_vbscript_exists
    executor: powershell
    inline: |
      if (-not (Test-Path "{{.Args.vbscript_path}}")) {
        Write-Error "VBScript not found at {{.Args.vbscript_path}}. Exiting..."
        exit 1
      }
  - name: execute_script
    executor: powershell
    inline: |
      {{ if eq .Args.method "cscript" }}
      cscript "{{.Args.vbscript_path}}"
      {{ else if eq .Args.method "wscript" }}
      wscript "{{.Args.vbscript_path}}" //T:1
      {{ end }}
