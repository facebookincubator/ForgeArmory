# Converted from Atomic Red Team - Unsecured Credentials: Credentials in Registry
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1552.002
# Original auto_generated_guid: b6ec082c-7384-46b3-a111-9a9b8b14e5e7

---
api_version: 2.0
uuid: a5fbdae2-1252-45d2-b06d-a2e2059d57cf
name: Enumeration for Credentials in Registry
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Queries to enumerate for credentials in the Registry. Upon execution, any registry key containing the word "password" will be displayed.

mitre:
  tactics:
    - "TA0006 Credential Access"
  techniques:
    - "T1552 Unsecured Credentials"
  subtechniques:
    - "T1552.002 Credentials in Registry"

requirements:
  platforms:
    - os: windows
  superuser: false

steps:
  - name: enumerate_hklm_passwords
    executor: cmd.exe
    inline: |
      reg query HKLM /f password /t REG_SZ /s

  - name: enumerate_hkcu_passwords
    executor: cmd.exe
    inline: |
      reg query HKCU /f password /t REG_SZ /s
