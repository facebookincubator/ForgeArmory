# Converted from Atomic Red Team - Hijack Execution Flow: Services Registry Permissions Weakness
# Source: https://www.atomicredteam.io/atomic-red-team/atomics/T1574.011
# Original auto_generated_guid: f7536d63-7fd4-466f-89da-7e48d550752a

---
api_version: 2.0
uuid: c326a93c-c2a4-4790-a04a-64f065184de8
name: Service Registry Permissions Weakness
authors:
  - isaac_fletcher
  - Atomic Red Team
description: |
  Service registry permissions weakness check and then which can lead to privilege escalation with ImagePath.

mitre:
  tactics:
    - "TA0004 Privilege Escalation"
    - "TA0003 Persistence"
  techniques:
    - "T1574 Hijack Execution Flow"
  subtechniques:
    - "T1574.011 Services Registry Permissions Weakness"

requirements:
  platforms:
    - os: windows
  superuser: true

args:
  - name: weak_service_name
    description: weak service check
    type: string
    default: "weakservicename"

steps:
  - name: check_service_registry_permissions
    executor: powershell
    inline: |
      get-acl REGISTRY::HKLM\SYSTEM\CurrentControlSet\Services\* | select-object -first 10  | FL
